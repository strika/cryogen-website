<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta content="width=device-width, initiali-scale=1.0, user-scalable=yes" name="viewport"><title>There are ants on the page - Rake and Rails environment</title><link href="/favicon.ico" rel="shortcut icon"><link href="/atom.xml" rel="alternate" title="Rake and Rails environment" type="application/atom+xml"><link href="/fonts/fira/fira.css" rel="stylesheet" type="text/css"><link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="/css/style.css" rel="stylesheet" type="text/css"><link href="/css/desert.css" rel="stylesheet" type="text/css"></head><body><div id="ant"></div><div class="container"><div class="row"><article class="col-sm-8 col-sm-offset-2 content"><div class="page-header"><h1>Rake and Rails environment</h1><p class="date">02 Feb 2014</p></div><div class="post"><p class="paragraph">I've been using Rake daily for more than 2 years now,
   but I never went through a proper tutorial about Rake.
   Lately, I learned few basic things about Rake that made
   task dependency much more clear.</p><p class="paragraph">Simplest way to define a rake task is this:</p><pre class="prettyprint">task :my_task do
  # do some stuff
end</pre><br><p class="paragraph">If you need to run :prepare task before :my_task, this
   is the way to do it:</p><pre class="prettyprint">task :my_task =&gt; :prepare do
  # do some stuff
end</pre><br><p class="paragraph">And when you need to run several tasks before :my_task, you
   can use an array:</p><pre class="prettyprint">task :my_task =&gt; [:clean, :prepare, :setup_logging] do
  # do some stuff
end</pre><br><p class="paragraph">Rake is using Ruby's flexible syntax to create a comfortable DSL for writing tasks
   (that may look strange at first).</p><h2>Rails' :environment task</h2><p class="paragraph">A special task that you probably encountered before is the :environment task:</p><pre class="prettyprint">task :my_task =&gt; :environment do
  # do some stuff
end</pre><br><p class="paragraph">The :environment task loads the Rails' environment so all you code and gems are available
   in :my_task.</p><h2>When not to use :environment task</h2><p class="paragraph">If you're writing a task that needs to be executed periodically, in short
   intervals and doesn't depend on lots of other code, don't use :environment task.
   Load dependencies manually instead. Running a task that depends on :environment
   can take 20-30 seconds or more since it's starting the whole Rails and loading
   all gems for the environment.</p></div></article></div><div class="row"><div class="col-sm-8 col-sm-offset-2 content comment"><p>Do you have a comment? Feel free to send me an <a href="mailto:nebojsa.stricevic@gmail.com">email</a> or message me at <a href="http://twitter.com/nstricevic">@nstricevic</a>.</p></div></div><footer><small>&copy; 2014 Nebojša Stričević</small></footer></div><script src="/js/prettify.js" type="text/javascript"></script><script src="/js/lang-clj.js" type="text/javascript"></script><script src="/js/main.js" type="text/javascript"></script></body></html>